# 제12회 단순회귀분석의 대표본이론 (Large Sample Theory for Simple Regression)

## 이 강의의 핵심

> **다변량 CLT를 회귀분석에 적용하여 OLS 추정량 $\hat{\beta}$의 분포를 구한다!**

### 전체 흐름
```
제11회: 다변량 CLT (이론)
     ↓
제12회: 회귀분석에 적용 (실전)
     ↓
결과: OLS 추정량의 일치성 + 점근적 정규성
```

### 왜 중요한가?
다변량 CLT 덕분에:
- $\hat{\beta}$의 **분포**를 알 수 있음
- **신뢰구간** 구성 가능
- **가설검정** 가능 (예: $H_0: \beta = 0$)

---

## 1. 복습: 다변량 중심극한정리

### 설정
$\mathbf{X}$: 기댓값 벡터 $\boldsymbol{\mu}$, 분산 행렬 $\boldsymbol{\Sigma}$

$$\boldsymbol{\mu} = \begin{pmatrix} \mu_1 \\ \mu_2 \end{pmatrix}, \quad \boldsymbol{\Sigma} = \begin{pmatrix} \sigma_{11} & \sigma_{12} \\ \sigma_{12} & \sigma_{22} \end{pmatrix}$$

### 분산 행렬의 성분
$$\sigma_{ij} = E[(X_i - \mu_i)(X_j - \mu_j)] = \text{Cov}(X_i, X_j)$$

### 다변량 CLT
$\mathbf{X}_1, \ldots, \mathbf{X}_N$: $\mathbf{X}$의 $N$개 독립 복사본

$$\sqrt{N}(\bar{\mathbf{X}}_N - \boldsymbol{\mu}) \xrightarrow{d} N(\mathbf{0}, \boldsymbol{\Sigma})$$

---

## 2. 1변량 CLT 복습

### 설정
$X$: 기댓값 $\mu = E[X]$, 분산 $\sigma^2 = E[(X-\mu)^2]$

### CLT
$X_1, \ldots, X_N$: 독립 복사본

$$\sqrt{N}(\bar{X}_N - \mu) \xrightarrow{d} N(0, \sigma^2)$$

---

## 3. 단순회귀모형 (Simple Regression Model)

### 모형
$$Y_i = \alpha + \beta X_i + \varepsilon_i, \quad i = 1, 2, \ldots, N$$

### 구성요소
| 기호 | 의미 | 특성 |
|------|------|------|
| $Y_i$ | 종속변수 (반응변수) | 관측됨 |
| $X_i$ | 독립변수 (설명변수) | 관측됨 |
| $\alpha$ | 절편 (intercept) | **미지수** |
| $\beta$ | 기울기 (slope) | **미지수** |
| $\varepsilon_i$ | 오차항 (error term) | 관측 안 됨 |

### 오차항 가정
$$\varepsilon_i \sim (0, \sigma_\varepsilon^2)$$

- $E[\varepsilon_i] = 0$
- $\text{Var}(\varepsilon_i) = \sigma_\varepsilon^2$
- $\varepsilon_i$들은 **서로 독립 (iid)**

---

## 4. 최소제곱법 (Ordinary Least Squares, OLS)

### 목표
잔차제곱합(RSS)을 최소화하는 $\hat{\alpha}, \hat{\beta}$ 찾기

$$S = \sum_{i=1}^{N} (Y_i - a - bX_i)^2$$

### 1차 조건 (First Order Conditions)

**$\partial S / \partial a = 0$:**
$$-2\sum_{i=1}^{N} (Y_i - a - bX_i) = 0$$

**$\partial S / \partial b = 0$:**
$$-2\sum_{i=1}^{N} (Y_i - a - bX_i)X_i = 0$$

### 정리하면
$$N\hat{\alpha} + \hat{\beta}\sum X_i = \sum Y_i$$
$$\hat{\alpha}\sum X_i + \hat{\beta}\sum X_i^2 = \sum X_i Y_i$$

---

## 5. OLS 추정량

### 기울기 추정량
$$\hat{\beta} = \frac{\sum_{i=1}^{N}(X_i - \bar{X})(Y_i - \bar{Y})}{\sum_{i=1}^{N}(X_i - \bar{X})^2}$$

또는:
$$\hat{\beta} = \frac{\frac{1}{N}\sum X_i Y_i - \bar{X}\bar{Y}}{\frac{1}{N}\sum X_i^2 - \bar{X}^2}$$

### 절편 추정량
$$\hat{\alpha} = \bar{Y} - \hat{\beta}\bar{X}$$

> **직접 유도해보기!** (중요)

---

## 6. 대표본 이론을 위한 설정

### 확률벡터 정의
$$\mathbf{Z}_i = \begin{pmatrix} X_i \\ Y_i \end{pmatrix} = \begin{pmatrix} X_i \\ \alpha + \beta X_i + \varepsilon_i \end{pmatrix}$$

### 기댓값 계산
$$E[\mathbf{Z}_i] = \begin{pmatrix} E[X_i] \\ E[Y_i] \end{pmatrix} = \begin{pmatrix} \mu_X \\ \alpha + \beta\mu_X \end{pmatrix}$$

(왜냐하면 $E[\varepsilon_i] = 0$)

---

## 7. 대수의 법칙 (Law of Large Numbers)

### 적용
$N \to \infty$일 때:

$$\frac{1}{N}\sum X_i \xrightarrow{p} E[X] = \mu_X$$

$$\frac{1}{N}\sum X_i^2 \xrightarrow{p} E[X^2]$$

$$\frac{1}{N}\sum X_i Y_i \xrightarrow{p} E[XY]$$

### 핵심 조건
$$\text{Var}(X) = E[X^2] - \mu_X^2 > 0$$

(설명변수에 **변동**이 있어야 함!)

---

## 8. 분산 행렬 계산

### 설정
$$\mathbf{Z}_i = \begin{pmatrix} X_i \\ X_i Y_i \end{pmatrix}$$

### 기댓값
$$\boldsymbol{\mu}_Z = \begin{pmatrix} \mu_X \\ E[XY] \end{pmatrix}$$

### 분산 행렬
$$\boldsymbol{\Sigma}_Z = E[(\mathbf{Z}_i - \boldsymbol{\mu}_Z)(\mathbf{Z}_i - \boldsymbol{\mu}_Z)^T]$$

$$= \begin{pmatrix} E[(X - \mu_X)^2] & E[(X - \mu_X)(XY - E[XY])] \\ E[(XY - E[XY])(X - \mu_X)] & E[(XY - E[XY])^2] \end{pmatrix}$$

---

## 9. 다변량 CLT 적용

### 표본평균 벡터
$$\bar{\mathbf{Z}}_N = \begin{pmatrix} \bar{X} \\ \overline{XY} \end{pmatrix} = \begin{pmatrix} \frac{1}{N}\sum X_i \\ \frac{1}{N}\sum X_i Y_i \end{pmatrix}$$

### CLT
$$\sqrt{N}(\bar{\mathbf{Z}}_N - \boldsymbol{\mu}_Z) \xrightarrow{d} N(\mathbf{0}, \boldsymbol{\Sigma}_Z)$$

---

## 10. OLS 추정량의 점근적 성질

### 일치성 (Consistency)
$$\hat{\beta} \xrightarrow{p} \beta \quad \text{as } N \to \infty$$
$$\hat{\alpha} \xrightarrow{p} \alpha \quad \text{as } N \to \infty$$

> 표본 크기가 커지면 추정량이 **참값으로 수렴**!

### 점근적 정규성 (Asymptotic Normality)
$$\sqrt{N}(\hat{\beta} - \beta) \xrightarrow{d} N(0, V_\beta)$$

여기서 $V_\beta$는 점근 분산 (asymptotic variance)

---

## 11. 마켓 모델 예시 (Market Model)

### 설정
**CAPM (자본자산가격결정모형)** 관련:

$$Y_i = \alpha + \beta X_i + \varepsilon_i$$

| 변수 | 의미 |
|------|------|
| $Y_i$ | NTT 주식의 로그수익률: $\log P_i - \log P_{i-1}$ |
| $X_i$ | 닛케이 평균의 로그수익률: $\log N_i - \log N_{i-1}$ |
| $\beta$ | 시장 베타 (market beta) |
| $\varepsilon_i$ | NTT 고유의 위험 (idiosyncratic risk) |

### 해석
- $\beta > 1$: 시장보다 변동성 큼 (공격적)
- $\beta < 1$: 시장보다 변동성 작음 (방어적)
- $\beta = 1$: 시장과 동일한 변동성

---

## 12. 다중회귀로의 확장

### $k$개 설명변수 모형
$$Y_i = \beta_0 + \beta_1 X_{1i} + \beta_2 X_{2i} + \cdots + \beta_k X_{ki} + \varepsilon_i$$

### 행렬 표기
$$\mathbf{Y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon}$$

여기서:
- $\mathbf{Y}$: $N \times 1$ 반응변수 벡터
- $\mathbf{X}$: $N \times (k+1)$ 설계행렬 (design matrix)
- $\boldsymbol{\beta}$: $(k+1) \times 1$ 모수 벡터
- $\boldsymbol{\varepsilon}$: $N \times 1$ 오차 벡터

### OLS 추정량
$$\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}$$

### 점근적 성질
- **일치성** (Consistency)
- **점근적 정규성** (Asymptotic Normality)

### 실제 응용: 다요인 모형 (Multi-Factor Model)

**단순 CAPM (1요인):**
$$R_{NTT} = \alpha + \beta_1 R_{Nikkei} + \varepsilon$$

**다요인으로 확장:**
$$R_{NTT} = \alpha + \beta_1 R_{Nikkei} + \beta_2 R_{NASDAQ} + \beta_3 R_{반도체} + \varepsilon$$

### Fama-French 3요인 모형 (학계 표준)

$$R = \alpha + \beta_1 (R_m - R_f) + \beta_2 \text{SMB} + \beta_3 \text{HML} + \varepsilon$$

| 요인 | 의미 |
|------|------|
| $R_m - R_f$ | 시장 초과수익률 |
| SMB | Small Minus Big (소형주 - 대형주) |
| HML | High Minus Low (가치주 - 성장주) |

### NTT에 적용 가능한 요인 예시

| 요인 | 근거 |
|------|------|
| 닛케이 지수 | 일본 시장 전체 |
| 나스닥 지수 | 글로벌 기술주 동향 |
| 반도체 지수 (SOX) | 통신 인프라 관련 |
| 엔/달러 환율 | 일본 기업 수출 영향 |
| 금리 (JGB) | 통신사 부채 비용 |

> **다요인 = 여러 요인으로 주가 설명 → 더 정교한 위험 분석!**

---

## 13. 핵심 공식 정리

| 개념 | 공식 |
|------|------|
| 단순회귀 모형 | $Y_i = \alpha + \beta X_i + \varepsilon_i$ |
| OLS 기울기 | $\hat{\beta} = \frac{\sum(X_i - \bar{X})(Y_i - \bar{Y})}{\sum(X_i - \bar{X})^2}$ |
| OLS 절편 | $\hat{\alpha} = \bar{Y} - \hat{\beta}\bar{X}$ |
| 일치성 | $\hat{\beta} \xrightarrow{p} \beta$ |
| 다중회귀 OLS | $\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}$ |

---

## 14. 이 강의의 핵심 메시지

1. **단순회귀의 OLS 추정량**
   - 잔차제곱합 최소화로 유도
   - 닫힌 형태(closed-form) 해 존재

2. **대수의 법칙 적용**
   - 표본 모멘트 → 모집단 모멘트 수렴

3. **다변량 CLT 적용**
   - OLS 추정량의 점근적 정규성 증명

4. **일치성과 점근적 정규성**
   - 대표본에서 OLS의 좋은 성질

5. **다중회귀로 확장**
   - 행렬 표기로 깔끔하게 일반화

---

## 15. Q&A

### Q1. 왜 "대표본" 이론인가?

**소표본(exact/finite sample) 이론:**
- $\varepsilon_i \sim N(0, \sigma^2)$ 가정 필요
- 정확한 분포 유도 가능

**대표본(large sample/asymptotic) 이론:**
- 정규성 가정 불필요
- CLT로 점근적 정규성 얻음
- 훨씬 **일반적**이고 **강건(robust)**

### Q2. 일치성이 왜 중요한가?

$$\hat{\beta} \xrightarrow{p} \beta$$

**의미:** 데이터가 많아질수록 추정량이 참값에 가까워짐

**없으면:** 아무리 데이터를 모아도 잘못된 값으로 수렴!

### Q3. 점근적 정규성은 어떻게 활용하나?

$$\sqrt{N}(\hat{\beta} - \beta) \xrightarrow{d} N(0, V)$$

**활용:**
- **신뢰구간** 구성: $\hat{\beta} \pm z_{\alpha/2} \cdot \sqrt{V/N}$
- **가설검정**: $H_0: \beta = 0$ 등
