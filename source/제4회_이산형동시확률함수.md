# 제4회 이산형 동시(결합) 확률함수

## 1. 복습과 전환

### 제3회까지
- 연속형 확률분포 (이변량 정규분포)
- 동시밀도함수, 조건부밀도함수
- 중적분 필요

### 제4회부터
- **이산형** 확률분포 (포아송 분포 등)
- 동시확률함수, 조건부확률함수
- 합(Σ)으로 계산

---

## 2. 포아송 분포 복습

### 정의
$$P(X = x) = \frac{\lambda^x e^{-\lambda}}{x!}, \quad x = 0, 1, 2, \ldots$$

### 모수
- λ = 단위 시간(공간)당 평균 발생 횟수

### 성질
| 성질 | 값 |
|---|---|
| 기대값 | E[X] = λ |
| 분산 | Var(X) = λ |

### 모멘트 생성함수 (MGF)
$$M_X(t) = E[e^{tX}] = \exp(\lambda(e^t - 1))$$

**유도 과정:**

$$M_X(t) = E[e^{tX}] = \sum_{x=0}^{\infty} e^{tx} \cdot P(X=x)$$

$$= \sum_{x=0}^{\infty} e^{tx} \cdot \frac{\lambda^x e^{-\lambda}}{x!}$$

$$= e^{-\lambda} \sum_{x=0}^{\infty} \frac{(e^t \lambda)^x}{x!}$$

테일러 급수: $e^a = \sum_{x=0}^{\infty} \frac{a^x}{x!}$ 이므로:

$$= e^{-\lambda} \cdot e^{\lambda e^t} = e^{-\lambda + \lambda e^t} = \exp(\lambda(e^t - 1))$$

---

## 3. 독립인 두 포아송 확률변수

### 설정
$$X \sim \text{Poisson}(\lambda_1), \quad Y \sim \text{Poisson}(\lambda_2)$$
$$X \perp Y \text{ (독립)}$$

### 동시확률함수 (독립인 경우)
$$P(X=x, Y=y) = P(X=x) \cdot P(Y=y)$$

> 독립이면 동시확률 = 주변확률의 곱

### 합의 분포
$$Z = X + Y \sim \text{Poisson}(\lambda_1 + \lambda_2)$$

**증명 (MGF 이용):**
$$M_Z(t) = E[e^{t(X+Y)}] = E[e^{tX}]E[e^{tY}] = M_X(t)M_Y(t)$$
$$= \exp(\lambda_1(e^t-1)) \cdot \exp(\lambda_2(e^t-1)) = \exp((\lambda_1+\lambda_2)(e^t-1))$$

---

## 4. 조건부 확률함수

### 정의
$$P_{X|Z}(x|z) = P(X=x | Z=z) = \frac{P(X=x, Z=z)}{P(Z=z)}$$

### 예제: X|Z=z의 분포

Z = X + Y 일 때, Z=z가 주어지면 X는?

$$X | Z=z \sim \text{Binomial}\left(z, \frac{\lambda_1}{\lambda_1+\lambda_2}\right)$$

| 이항분포 모수 | 값 |
|---|---|
| 시행 횟수 n | z |
| 성공 확률 p | $\frac{\lambda_1}{\lambda_1+\lambda_2}$ |

---

## 5. 조건부 기대값

### 정의
$$E[X | Z=z] = \sum_x x \cdot P_{X|Z}(x|z)$$

> "Z=z가 주어졌을 때, X가 취할 수 있는 값들의 가중평균"

### 예제에서
$$E[X|Z=z] = z \cdot \frac{\lambda_1}{\lambda_1+\lambda_2}$$

이항분포 B(n,p)의 기대값 = np 이므로.

---

## 6. 조건부 기대값을 확률변수로 보기

### 소문자 z → 대문자 Z
$$E[X|Z=z] = z \cdot \frac{\lambda_1}{\lambda_1+\lambda_2}$$

z를 확률변수 Z로 바꾸면:
$$E[X|Z] = Z \cdot \frac{\lambda_1}{\lambda_1+\lambda_2}$$

> **E[X|Z]는 Z의 함수 → 확률변수!**

---

## 7. 반복기대값 공식 (Law of Iterated Expectations)

### 핵심 공식
$$E[E[X|Z]] = E[X]$$

> "조건부 기대값의 기대값 = 무조건부 기대값"

### 예제에서 검증
$$E[E[X|Z]] = E\left[Z \cdot \frac{\lambda_1}{\lambda_1+\lambda_2}\right] = \frac{\lambda_1}{\lambda_1+\lambda_2} \cdot E[Z]$$
$$= \frac{\lambda_1}{\lambda_1+\lambda_2} \cdot (\lambda_1 + \lambda_2) = \lambda_1 = E[X]$$

✅ 검증 완료!

### 일반적 증명
$$E[E[X|Z]] = \sum_z E[X|Z=z] \cdot P(Z=z)$$
$$= \sum_z \left(\sum_x x \cdot P_{X|Z}(x|z)\right) P_Z(z)$$
$$= \sum_z \sum_x x \cdot P_{X,Z}(x,z)$$
$$= \sum_x x \cdot P_X(x) = E[X]$$

---

## 8. 곱셈공식 (이산형)

### 확률 버전
$$P(A \cap B) = P(A) \cdot P(B|A)$$

### 확률함수 버전
$$P_{X,Z}(x,z) = P_Z(z) \cdot P_{X|Z}(x|z)$$

| 용어 | 의미 |
|---|---|
| $P_{X,Z}(x,z)$ | 동시(결합) 확률함수 |
| $P_Z(z)$ | Z의 주변확률함수 |
| $P_{X\|Z}(x\|z)$ | 조건부 확률함수 |

---

## 9. 주변확률함수

### 동시확률함수로부터 유도
$$P_Z(z) = P(Z=z) = \sum_x P_{X,Z}(x,z)$$

> "다른 변수에 대해 합산"

---

## 10. 공분산 (이산형)

### 정의
$$\sigma_{X,Z} = \text{Cov}(X,Z) = E[(X-\mu_X)(Z-\mu_Z)]$$

### 공분산 공식
$$\text{Cov}(X,Z) = E[XZ] - \mu_X \mu_Z$$

### 기술통계 vs 추측통계

| | 기술통계 | 추측통계 |
|---|---|---|
| 공분산 | $s_{XZ} = \frac{1}{N}\sum(X_i-\bar{X})(Z_i-\bar{Z})$ | $\sigma_{XZ} = E[(X-\mu_X)(Z-\mu_Z)]$ |
| 용어 | 표본 공분산 | 모공분산 |

---

## 11. 핵심 공식 정리

| 개념 | 공식 |
|---|---|
| 동시확률함수 | $P_{X,Y}(x,y) = P(X=x, Y=y)$ |
| 주변확률함수 | $P_X(x) = \sum_y P_{X,Y}(x,y)$ |
| 조건부확률함수 | $P_{X\|Y}(x\|y) = \frac{P_{X,Y}(x,y)}{P_Y(y)}$ |
| 조건부기대값 | $E[X\|Y=y] = \sum_x x \cdot P_{X\|Y}(x\|y)$ |
| 반복기대값 공식 | $E[E[X\|Y]] = E[X]$ |

---

## 12. 이 강의의 핵심 메시지

1. **이산형에서도 같은 구조**
   - 연속형의 밀도함수 → 이산형의 확률함수
   - 적분 → 합(Σ)

2. **반복기대값 공식**
   - 조건부 기대값을 계산한 후, 그것의 기대값을 구하면 원래 기대값
   - 이후 강의에서 계속 사용되는 중요한 도구

3. **포아송 합 = 포아송**
   - 독립인 포아송의 합은 다시 포아송

---

## 13. Q&A: 자주 헷갈리는 개념들

### Q1. 모멘트 생성함수 (MGF) 란?

**정의:**
$$M_X(t) = E[e^{tX}]$$

**왜 쓰나?**
1. 분포를 유일하게 결정 (MGF가 같으면 분포도 같다)
2. 모멘트 계산이 쉬움: $M_X'(0) = E[X]$, $M_X''(0) = E[X^2]$
3. 합의 분포: 독립이면 $M_{X+Y}(t) = M_X(t) \cdot M_Y(t)$

---

### Q2. 왜 Z = X + Y 를 계산하나?

**예시: 기념품 가게**
- X = 구매 고객 수 ~ Poisson(λ₁)
- Y = 비구매 고객 수 ~ Poisson(λ₂)
- **Z = X + Y = 총 방문 고객 수**

> Z를 정의하면 "Z=z명이 왔을 때, 그 중 몇 명이 샀는가?" 같은 **조건부 질문**이 가능해짐

**강의의 핵심 목적:** 조건부 확률함수와 반복기대값 공식을 연습하기 위한 설정!

---

### Q3. 왜 조건에 Z를 놓는가?

**현실적 상황:**
```
기념품 가게에 총 10명(Z=10)이 방문했다.
이 중 몇 명(X)이 물건을 샀을까?
```

- 알고 있는 것: 총 방문객 Z=10
- 알고 싶은 것: 구매자 수 X
- 필요한 것: **P(X=x | Z=z)**

---

### Q4. 예제 X|Z=z ~ 이항분포 해설

**질문:** "총 z명이 왔을 때, 그 중 x명이 구매할 확률은?"

**답:**
$$X | Z=z \sim \text{Binomial}\left(z, \frac{\lambda_1}{\lambda_1+\lambda_2}\right)$$

**직관적 해석:**
- z명 중 각자가 "구매 고객"일 확률 = $\frac{\lambda_1}{\lambda_1+\lambda_2}$
- z번의 독립 시행에서 성공 횟수 → 이항분포!

**숫자 예시:**
- λ₁ = 3 (시간당 평균 구매자)
- λ₂ = 7 (시간당 평균 비구매자)
- 구매 확률 p = 3/(3+7) = 0.3

> "총 10명이 왔을 때, 구매자 수 X는 Binomial(10, 0.3)을 따른다"

---

### Q5. MGF의 핵심 성질: 일대일 대응

> **두 확률변수의 MGF가 같으면, 분포도 같다**

이것이 왜 중요한가?
- Z = X + Y의 MGF를 계산
- 그 결과가 Poisson(λ₁+λ₂)의 MGF와 같음
- → Z ~ Poisson(λ₁+λ₂) 라고 결론!

---

### Q6. 왜 갑자기 이항분포 (Binomial) 가 등장하나?

**상황 복기:**
- X ~ Poisson(λ₁), Y ~ Poisson(λ₂), Z = X + Y
- 질문: "Z=z명이 왔을 때, X=x명이 구매할 확률은?"

**핵심 통찰:**
- 총 z명 중 각 사람이 "구매 고객(X 쪽)"일 확률 = $\frac{\lambda_1}{\lambda_1+\lambda_2}$
- 이것은 **z번의 독립 시행에서 성공 횟수를 세는 것** → 이항분포!

**비유:**
- 동전을 z번 던져서 앞면(구매) 나온 횟수
- 앞면 확률 p = λ₁/(λ₁+λ₂)

---

### Q7. 대문자 vs 소문자

| 표기 | 의미 | 예시 |
|---|---|---|
| **X, Y, Z** (대문자) | **확률변수** (아직 값이 정해지지 않음) | "X는 구매 고객 수" |
| **x, y, z** (소문자) | **특정 값** (확률변수가 취한 구체적 수) | "x = 3명이 구매함" |

**예시:**
- $P(X = x)$: "확률변수 X가 값 x를 가질 확률"
- $E[X|Z=z]$: "Z=z(특정 값)일 때 X(확률변수)의 기대값"
- $E[X|Z]$: Z도 확률변수로 보면, 이것도 **확률변수**가 됨

---

### Q8. 포아송의 조건부분포가 항상 이항분포인가?

**아니요!** 다음의 **특정 조건**에서만 성립:

| 조건 | 내용 |
|---|---|
| $X \sim \text{Poisson}(\lambda_1)$ | |
| $Y \sim \text{Poisson}(\lambda_2)$ | |
| X와 Y가 **독립** | |
| $Z = X + Y$ (합) | |

**이 조건에서:**
$$X | Z=z \sim \text{Binomial}\left(z, \frac{\lambda_1}{\lambda_1 + \lambda_2}\right)$$

> **요약**: "독립 포아송의 **합**을 조건으로 줄 때" 이항분포가 됨
